@use "@nationalarchives/frontend/nationalarchives/variables/a11y" as
  a11yVariables;
@use "@nationalarchives/frontend/nationalarchives/variables/borders" as
  borderVars;
@use "@nationalarchives/frontend/nationalarchives/tools/a11y";
@use "@nationalarchives/frontend/nationalarchives/tools/borders";
@use "@nationalarchives/frontend/nationalarchives/tools/colour";
@use "@nationalarchives/frontend/nationalarchives/tools/media";
@use "@nationalarchives/frontend/nationalarchives/tools/spacing";
@use "@nationalarchives/frontend/nationalarchives/tools/typography";

@use "@nationalarchives/frontend/nationalarchives/all";

$refresh-banner-height: 2.5rem;

.tna-template {
  &--padded {
    scroll-padding: $refresh-banner-height;
  }
}

.tna-main {
  position: relative;
}

.tna-refresh-banner {
  overflow: visible;

  position: absolute;
  inset: 0;
  z-index: 4;

  line-height: $refresh-banner-height;
  pointer-events: none;

  &__content {
    @include typography.font-size(16);

    height: $refresh-banner-height;

    position: sticky;
    top: 0;
    pointer-events: all;

    p {
      @include typography.main-font-weight-medium;
    }
  }

  &:not([hidden]) {
    + * {
      margin-top: $refresh-banner-height;
    }
  }
}

.tna-back-link {
  display: inline-flex;
  gap: spacing.space(0.5);

  &,
  &:visited {
    @include colour.colour-font("font-base");
  }

  &,
  &:hover,
  &:focus-visible {
    text-decoration: none;
  }

  &__inner {
    text-decoration: underline;
    @include typography.interactable-text-decoration;
  }

  &:hover &__inner,
  &:focus-visible &__inner {
    @include typography.interacted-text-decoration;
  }

  &::before {
    content: "\2039";
    content: "\2039" / "";
  }
}

.tna-warning {
  p {
    margin-top: spacing.space(0.5);
  }
}

.tna-dl {
  &--small {
    @include typography.font-size(16);
  }

  &--tiny {
    @include typography.font-size(14);
  }

  &--stacked#{&}--plain {
    > dd {
      &:last-child {
        padding-bottom: 0;
      }
    }
  }

  &--50-50 {
    > dt,
    > dd {
      width: 50%;
    }

    @include media.on-tiny {
      > dt,
      > dd {
        width: 100%;
      }

      > dt {
        --background: var(--background-tint);

        @include colour.colour-background("background");
      }

      > dd {
        background-color: transparent !important;
      }
    }
  }
}

.tna-monitor-summary-wrapper {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: spacing.space(1);

  @include media.on-medium {
    grid-template-columns: repeat(2, 1fr);
  }

  @include media.on-mobile {
    grid-template-columns: 1fr;
    gap: spacing.space(0.5);
  }
}

.tna-monitor-summary {
  display: flex;
  align-items: stretch;
  justify-content: stretch;

  position: relative;

  &__icon {
    @include colour.accent;
    @include typography.font-size(32);

    width: 4rem;

    display: flex;
    align-items: center;
    justify-content: center;

    border-radius: borderVars.$rounded-border-radius 0 0
      borderVars.$rounded-border-radius;
  }

  &__content {
    @include colour.accent-light;

    flex: 1;

    padding: spacing.space(0.75) spacing.space(1);
    border-left: none;

    border-radius: 0 borderVars.$rounded-border-radius
      borderVars.$rounded-border-radius 0;

    p {
      @include typography.font-size(16);
      line-height: 1.5;
    }
  }

  .tna-heading-s a {
    &::before {
      @include borders.rounded-border;

      content: "";

      position: absolute;
      inset: 0;
      z-index: 3;
    }

    &:hover {
      &::before {
        @include colour.colour-border(
          "accent-background",
          a11yVariables.$focus-outline-width
        );
      }
    }

    &:focus-visible,
    &:active {
      outline: none;

      &::before {
        @include a11y.focus-outline;
      }
    }

    &:active {
      &::before {
        @include a11y.active-outline;
      }
    }
  }

  @include media.on-mobile {
    &__icon {
      @include typography.font-size(24);
      width: 3rem;
    }

    &__content {
      padding: spacing.space(0.5) spacing.space(0.75);
    }
  }
}

.tna-monitor {
  @include colour.colour-border("keyline", 1px, solid, bottom);

  padding-top: spacing.space(1.5);
  padding-bottom: spacing.space(1.5);
}

.tna-heartbeats {
  height: 2rem;
  margin-top: spacing.space(1);
  padding-top: spacing.space(1.25);

  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 1px;

  position: relative;

  list-style: none;

  &::before,
  &::after {
    @include typography.font-size(16);

    position: absolute;
    top: 0;

    line-height: 1;
    line-height: 1cap;
  }

  &::before {
    content: attr(data-oldest-heartbeat);

    left: 0;
  }

  &::after {
    content: attr(data-newest-heartbeat);

    right: 0;
  }

  &__item {
    @include colour.accent;
    @include borders.rounded-border;

    height: 2rem;
    margin: 0;

    position: relative;
    z-index: 1;

    font-size: 0;
    flex: 1;

    &--status-down {
      @include colour.pink-accent;
    }

    &--status-up {
      @include colour.green-accent;
    }

    &--status-pending {
      @include colour.yellow-accent;
    }

    &--status-maintenance {
      @include colour.blue-accent;
    }

    // &--status-up + &--status-down,
    // &--status-pending + &--status-down {
    //   &::after {
    //     content: "‚ùå";

    //     width: 1rem;

    //     position: absolute;
    //     top: 100%;
    //     left: 50%;
    //     z-index: 2;

    //     transform: translateX(-50%);

    //     @include typography.font-size(16);
    //   }
    // }
  }

  @include media.on-mobile {
    &::before {
      content: attr(data-oldest-heartbeat-mobile);
    }

    &__item {
      &--hide-on-mobile {
        display: none;
      }
    }
  }

  &--tight {
    gap: 0;
  }
}

dt:has(.tna-status-example) {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: spacing.space(0.75);
}

.tna-status-example {
  width: 1em;
  height: 1em;

  display: inline-block;

  @include colour.accent;
  @include borders.rounded-border;

  &--down {
    @include colour.pink-accent;
  }

  &--up {
    @include colour.green-accent;
  }

  &--pending {
    @include colour.yellow-accent;
  }

  &--maintenance {
    @include colour.blue-accent;
  }
}
